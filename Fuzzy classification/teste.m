close all;
V = [7, 6,    4,    4,    3,    2,    0,   -1,   -2,   -4,   -5,   -7,  -9,  -12,  -12,  -13,  -10,   -9,    0,   15,   38,   67,  103,  140,  177,  214,  245,  272,  288,  295,  295,  283,  265,  240,  212,  177,  141,  105,   68,   35,    3,  -26,  -50,  -70,  -86,  -99, -107, -112, -115, -115, -112, -107,  -99,  -88,  -74,  -60,  -45,  -27,   -9,    9,   23,   37,   49,   58,   64,   65,   65,   61,   56,   48,   40,   31,   19,    8,   -3,  -14,  -25,  -35,  -43,  -50,  -56,  -62,  -65,  -68,  -69,  -69,  -68,  -66,  -62,  -59,  -55,  -50,  -46,  -40,  -34,  -29,  -23,  -17,  -13,   -9,   -7,   -4,    0,    1,    2,    4];
f_norm = sqrt(sum(V.^2));
snr = 0;

V = V/f_norm;

n = numel(V);
Vext = [zeros(1,n) V zeros(1,n)*1.3];
Vruido = awgn(Vext,snr);

Vs = smooth(Vruido)';
% plot(V)
subplot(211);
hold on
plot(Vext);
% plot(Vruido);
% plot(Vs)
% legend("Vext", "Vruido", "Vs");
subplot(212);
err = Vs-Vext;
plot(err)
fprintf("Erro max: %d\n",max(err))
